import "@cadl-lang/rest";
import "@cadl-lang/versioning";
import "@cadl-lang/openapi3";

@versioned("l1" | "l2")
namespace Lib {
  model Spread<T> {
    ...T;
    spread: boolean;
  }
}

@serviceTitle("Repro")
@versioned("v1" | "v2")
@versionedDependency(
  Lib,
  {
    v1: "l1",
    v2: "l2",
  }
)
namespace Repro {
  // repro
  op test(): Lib.Spread<{
    @added("v2") color: string;
  }>;

  // no repro
  // op test(): Car;

  model Car {
    @added("v2") color: string;
  }
}
